<body class="bg-neutral-950 text-gray-100 font-sans p-10 min-h-screen">

  <div class="mb-6 flex items-center gap-4">
    <div class="bg-neutral-900 border border-zinc-800 rounded-lg shadow-md p-2 px-10">
      <p class="font-semibold">Thread</p>
      <p class="text-2xl font-bold">
        {{(remainingTasks$ | async)?.threadInUse || 0}}
        /
        {{(remainingTasks$ | async)?.totalThread || 0}}
      </p>
    </div>

    <div class="bg-neutral-900 border border-zinc-800 rounded-lg shadow-md p-2 px-10">
      <p class="font-semibold">Remaining Batch</p>
      <p class="text-2xl font-bold">{{(remainingTasks$ | async)?.remainingBatches || 0}} </p>
    </div>

    <div class="bg-neutral-900 border border-zinc-800 rounded-lg shadow-md p-2 px-10">
      <p class="font-semibold">Not Started Jobs</p>
      <p class="text-2xl font-bold">{{(remainingTasks$ | async)?.notStartedJobs || 0}} </p>
    </div>

    <div class="bg-neutral-900 border border-zinc-800 rounded-lg shadow-md p-2 px-10">
      <p class="font-semibold">Pending Jobs</p>
      <p class="text-2xl font-bold">{{(remainingTasks$ | async)?.pendingJobs || 0}} </p>
    </div>

    <div class="bg-neutral-900 border border-zinc-800 rounded-lg shadow-md p-2 px-10">
      <p class="font-semibold">Running Jobs</p>
      <p class="text-2xl font-bold">{{(remainingTasks$ | async)?.runningJobs || 0}} </p>
    </div>

    <div class="bg-neutral-900 border border-zinc-800 rounded-lg shadow-md p-2 px-10">
      <p class="font-semibold">Finished Jobs</p>
      <p class="text-2xl font-bold">{{(remainingTasks$ | async)?.finishedJobs || 0}} </p>
    </div>

    <div class="bg-neutral-900 border border-zinc-800 rounded-lg shadow-md p-2 px-10">
      <p class="font-semibold">Failed Jobs</p>
      <p class="text-2xl font-bold">{{(remainingTasks$ | async)?.failedJobs || 0}} </p>
    </div>
  </div>

  <div class="bg-neutral-900 border border-zinc-800 rounded-lg shadow-md p-2 px-4 mb-6 flex items-center gap-4">
    <mat-form-field class="w-48">
      <mat-label>Nb of process</mat-label>
      <input matInput type="number" [(ngModel)]="nbOfProcess"
             class="bg-gray-900 text-gray-100 rounded-lg px-3 py-2 focus:outline-none" />
    </mat-form-field>

    <mat-form-field class="w-48">
      <mat-label>Red deepness</mat-label>
      <input matInput type="number" [(ngModel)]="redDeepness"
             class="bg-gray-900 text-gray-100 rounded-lg px-3 py-2 focus:outline-none" />
    </mat-form-field>

    <mat-form-field class="w-48">
      <mat-label>Yellow deepness</mat-label>
      <input matInput type="number" [(ngModel)]="yellowDeepness"
             class="bg-gray-900 text-gray-100 rounded-lg px-3 py-2 focus:outline-none" />
    </mat-form-field>

    <button (click)="startBatch()"
            class="ml-auto bg-neutral-100 text-zinc-800 px-24 py-2 rounded-lg shadow hover:brightness-90 transition">
      Start
    </button>
  </div>


  <div class="bg-neutral-900 border border-zinc-800 rounded-lg shadow-md overflow-x-auto p-4">
    <table class="min-w-full border border-zinc-800 rounded-md divide-y divide-zinc-800 overflow-hidden">
      <tr>
        <th class="px-4 py-2 text-left">Batch UUID</th>
        <th class="px-4 text-left">Jobs UUID</th>
        <th class="px-4 text-left">Status</th>
        <th class="px-4 text-left">Red Deepness</th>
        <th class="px-4 text-left">Yellow Deepness</th>
        <th class="px-4 text-left">Game Time</th>
        <th class="px-4 text-left">Winner</th>
        <th class="px-4 text-left">NB of moves</th>
      </tr>

      @for (element of (jobsArray$ | async); track element.jobsId) {
        <tr class="hover:bg-neutral-800 transition-colors duration-200">
          <td class="px-4 py-3">{{element.batchId}}</td>
          <td class="px-4">{{element.jobsId}}</td>
          <td class="px-4">{{element.status}}</td>
          <td class="px-4">{{element.stats ? element.stats.redDeepness : 'NOT FINISHED'}}</td>
          <td class="px-4">{{element.stats ? element.stats.yellowDeepness : 'NOT FINISHED'}}</td>
          <td class="px-4">{{element.stats ? msToTime(element.stats.gameTime) : 'NOT FINISHED'}}</td>
          <td class="px-4">{{element.stats ? (element.stats.doesRedWin === null ? 'DRAW' : element.stats.doesRedWin ? 'RED' : 'YELLOW') : 'NOT FINISHED'}}</td>
          <td class="px-4">{{element.stats ? element.stats.moves.length : 'NOT FINISHED'}}</td>
        </tr>
      }
    </table>
  </div>

</body>
